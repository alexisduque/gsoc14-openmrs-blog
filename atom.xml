<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[My GSOC 2014 Blog]]></title>
  <link href="http://alexisduque.github.io/atom.xml" rel="self"/>
  <link href="http://alexisduque.github.io/"/>
  <updated>2014-08-17T07:55:32+02:00</updated>
  <id>http://alexisduque.github.io/</id>
  <author>
    <name><![CDATA[Alexis Duque]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Final week ...]]></title>
    <link href="http://alexisduque.github.io/blog/2014/08/17/final-week-dot-dot-dot/"/>
    <updated>2014-08-17T06:53:20+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/08/17/final-week-dot-dot-dot</id>
    <content type="html"><![CDATA[<p><img src="https://1-ps.googleusercontent.com/sx/s.google-melange.appspot.com/www.google-melange.com/soc/content/2-1-20140317-p1/images/gsoc/logo/920x156xbanner-gsoc2014.png.pagespeed.ic.gdr4t3Igca.png" alt="" /></p>

<p>Hello folks,</p>

<p>Time is running out and this week was the last one, as a Gsoc student with OpenMRS. :disappointed_relieved:</p>

<p>This summer was awesome, and I really have a lot of fun. Atlas Project is definitely a success and I hope it can help saving life, or make the community keep growing.</p>

<p>All initial goals has been reached, and probably a bit more. In my point of view, success of Atlas project isn&rsquo;t just new features, but becoming an active OpenSource developer and finally forgetting the project was part of a Google program.</p>

<p>Working in pair with Burke - my mentor - was an unforgettable experience and, all along the summer he become a good friend. So I hope we can continue working together and we can meet, somewhere else than in front of a laptop :smirk:</p>

<p>There left an among of interesting work to do with OpenMRS and I get involved in some of them :
- Continue improving and  maintaining OpenMRS Atlas.
- Working with Elliott on a Modulus Docker container for developers.
- Working on different ways to use Docker in order to improve developers work-flow.
- &hellip;.</p>

<p>To conclude, here is the final presentation. You&rsquo;re invited to discuss it on <a href="https://talk.openmrs.org/t/gsoc-2014-atlas-module-2-0-final-presentation/489">OpenMRS Talk</a> and give your feedback :speech_balloon:</p>

<p><em>Alexis</em></p>

<hr />

<p><embed src='http://alexisduque.github.io/slides/final-presentation.html' allowFullScreen='true' width='640' height='480' align='middle'></embed></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Docker for developers]]></title>
    <link href="http://alexisduque.github.io/blog/2014/08/10/docker-for-developers/"/>
    <updated>2014-08-10T14:33:28+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/08/10/docker-for-developers</id>
    <content type="html"><![CDATA[<h2>Introduction</h2>

<p><img src="http://alexisduque.github.io/images/docker.png" width="200" title="Docker" ></p>

<p>As a developer, sometimes it may be painful to setup a working environment before coding. Some application may have very specific requirements and developers are not always familiar with things that usually Sysadmins do : I remember when I had to setup a working local ID Dashboard with an OpenLDAP Server, so painful ! :sweat_smile:</p>

<p>An other sensitive point is that local environment may be different from production, and code that work locally can fail when deployed.</p>

<p>In order to make things easier, Docker can help us. I will try to give you in few step, how to start quickly hacking and contributing to OpenMRS Atlas, without setting up anything.</p>

<h2>Before you start</h2>

<ul>
<li>Install Docker (see <a href="http://alexisduque.github.io/blog/2014/07/27/week-10/">recent blog post</a> or <a href="http://docs.docker.com/installation/">Docker site</a>).</li>
<li>It&rsquo;s easier if your 80, 443 and 8888 ports are free, so stop apache if it&rsquo;s running.</li>
<li>A reliable Internet connection is required</li>
</ul>


<h2>Get the code</h2>

<ol>
<li>Fork the <a href="https://github.com/openmrs/openmrs-contrib-atlas.git">openmrs-contrib-atlas</a> repository on Github</li>
<li>Clone your fork. We will assume that we wan&rsquo;t to clone in /home/user/atlas :
<code>mkdir atlas &amp;&amp; git clone https://github.com/alexisduque/openmrs-contrib-atlas.git /home/user/atlas</code></li>
</ol>


<h2>Build the container</h2>

<p>OpenmMRS Atlas container for developers is hosted on OpenMRS Docker Hub repository. Next step will pull the image and build the container, using environement variable you pass. It may takes about 10 minutes depending on your Internet connection.</p>

<p><code>docker run -e HOST_IP=127.0.0.1 -v /home/user/atlas:/opt/atlas -p 80:80 -p 443:443 -p 8888:8888 -p 22:22 --name atlas -h atlas openmrs/atlas:2.0-dev</code></p>

<h3>Explanation</h3>

<ul>
<li><code>docker run</code>  create a container named <strong>atlas</strong> using <strong>openmrs/atlas:2.0-dev</strong> image.</li>
<li>We mount (<code>-v</code>) local <strong>/home/user/atlas</strong> into /opt/atlas in the container.</li>
<li>We set container hostname (<code>-h</code>) to <em>atlas</em>.</li>
<li>We map 80, 8888 and 443 host port (<code>-p</code>) with same ports in the container.</li>
</ul>


<h3>Test and code</h3>

<p>You now can navigate through the Atlas at <a href="https://127.0.0.1">https://127.0.0.1</a> ! :smiley:</p>

<p>Open /home/user/atlas with your favorite IDE, code, test, commit and PR !</p>

<h3>Manage the container</h3>

<ol>
<li><strong>Shutdown</strong> the container when you finish your work : <code>docker stop atlas</code></li>
<li><strong>Start</strong> the container when needed : <code>docker start atlas</code></li>
<li><strong>Delete</strong> the container : <code>docker rm atlas</code>. Don&rsquo;t worry, your code in /home/user/atlas will persist.</li>
</ol>


<h3>Tips</h3>

<ul>
<li>You can ssh and explore the container (credentials: root/password) : <code>ssh root@0.0.0.0</code>.</li>
<li>OpenMRS credential for Atlas Sign In : user/user.</li>
<li>Mysql server admin credentials : root/mysql .</li>
</ul>


<h3>Advanced Configuration</h3>

<p><strong>If you want to change Atlas container port mapping</strong>, change <code>-p HOST_PORT:CONTAINER_PORT</code>  <strong>AND</strong> add custom env variables to change Atlas configuration:</p>

<ul>
<li><code>-e HTTP_PORT=</code> : HTTP port to access Atlas application (default : 80)</li>
<li><code>-e HTTPS_PORT=</code> : HTTPS port to access Atlas application default : 443)</li>
</ul>


<p><strong>Example</strong> : use 81, 444, 23 port and sources in /var/www/atlas.</p>

<p><code>docker run -e HOST_IP=127.0.0.1 -e HTTP_PORT=41 -e HTTPS_PORT=444 -v /var/www/atlas:/opt/atlas -p 81:80 -p 444:443 -p 8888:8888 -p 23:22 --name atlas -h atlas openmrs/atlas:2.0-dev</code></p>

<h3>Docker Advantages</h3>

<ul>
<li>Lighter than VM.</li>
<li>Portable and reusable environment.</li>
<li>No time wasted. :clock1:</li>
</ul>


<h3>Conclusion</h3>

<p>Using docker instead of a <em>classic</em> environment, you avoid installing and configuring Apache, Mysql, Php, Laravel, Composer, phantomJS, ID Dashboard, and seeding the database.</p>

<p>Moreover, you can be sure you have the same environment than other developers.</p>

<p>So, convinced ?</p>

<p><em>Alexis</em></p>

<p>PS : I need your feedback! Please report any problem and ask questions if needed.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 12]]></title>
    <link href="http://alexisduque.github.io/blog/2014/08/10/week-12/"/>
    <updated>2014-08-10T12:12:35+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/08/10/week-12</id>
    <content type="html"><![CDATA[<p>Hey ! :bowtie:</p>

<p>End of Summer of Code is coming and it&rsquo;s time to wrap up the project.</p>

<p>So, this week I didn&rsquo;t produce so much code and I focused on writing documentation, release note, update Atlas Wiki pages, and preparing the final video presentation.</p>

<p>Thank to James reporting <a href="https://issues.openmrs.org/browse/ATLAS-107">ATLAS-107</a>, it&rsquo;s always nice to see that folks take care of Atlas :smirk:</p>

<p>That&rsquo;s it for this week, I will post the video presentation soon, so stay tuned !</p>

<p><em>Alexis</em></p>

<h2>Atlas related Wiki</h2>

<ul>
<li><a href="https://wiki.openmrs.org/display/docs/Atlas+Module+2.0+User+Guide">Atlas Module user guide</a></li>
<li><a href="https://wiki.openmrs.org/display/docs/Atlas+Module">Atlas Module wiki</a></li>
<li><a href="https://wiki.openmrs.org/display/docs/OpenMRS+Atlas">OpenmMRS Atlas wiki</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dockerfile]]></title>
    <link href="http://alexisduque.github.io/blog/2014/08/03/dockerfile/"/>
    <updated>2014-08-03T10:27:35+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/08/03/dockerfile</id>
    <content type="html"><![CDATA[<p>This is next post about Docker, and today, we will see how we can automate Docker image creation using a <strong>Dockerfile</strong> : what it is and what it is capable of doing.</p>

<p><img class="left" src="http://alexisduque.github.io/images/docker.png" width="200" title="Docker" ></p>

<h2>Commands for automation</h2>

<p>DockerFile is a script that contains instructions needed to create an image. The image can then be created based on the instructions in the DockerFile using the <code>docker build</code> command.</p>

<p>It simplifies deployment of an image by easing the entire image and container creation process.</p>

<p>Dockerfile can be hosted on Github and linked with <a href="https://hub.docker.com/">Docker Hub</a> to trigger change as a CI process. More information about <strong>automated build</strong> <a href="https://docs.docker.com/docker-hub/builds">here</a></p>

<h2>DockerFiles support commands in the following syntax:</h2>

<pre><code>INSTRUCTION argument
</code></pre>

<p>Instructions are not case sensitive. However, they are capitalized for a naming convention.</p>

<p>All DockerFiles must begin with the <strong>FROM</strong> command. The <strong>FROM</strong> command indicates the base image from which the new image will be created and from which all subsequent instructions will follow. The <strong>FROM</strong> command can be used any number of times, indicating the creation of multiple images. The syntax is as follows:</p>

<pre><code>FROM &lt;image name&gt;
FROM ubuntu
</code></pre>

<p>Will build a new image from the base Ubuntu image.</p>

<p>Following command are used to build your image:</p>

<p><strong>MAINTAINER:</strong>  Set an author field for the image using this instruction.</p>

<pre><code>MAINTAINER &lt;author name&gt;
</code></pre>

<p><strong>RUN:</strong> Execute a command in a shell or exec form. The RUN instruction adds a new layer on top of the newly created image. The committed results are then used for the next instruction in the DockerFile.</p>

<pre><code>RUN &lt;command&gt;
</code></pre>

<p><strong>ADD:</strong> Copy files from one location to another using the ADD instruction. It takes two arguments <source> and <destination>. The destination is a path in the container. The source can be either a URL or a file in the context of the launch config.</p>

<pre><code>ADD source destination
</code></pre>

<p><strong>CMD:</strong> Defaults for an executing container are provided using the CMD command. DockerFile allows usage of the CMD instruction only once. Multiple usage of CMD nullifies all previous CMD instructions. CMD comes in three flavours:</p>

<pre><code>CMD ["executable","param1","param2"]
CMD ["param1","param2"]
CMD command param1 param2
</code></pre>

<p><strong>EXPOSE:</strong> Specify the port on which the container will be listening at runtime by running the EXPOSE instruction.</p>

<pre><code>EXPOSE &lt;port&gt;;
</code></pre>

<p><strong>ENTRYPOINT</strong> Configure a container to run as an executable, which means a specific application can be set as default and run every time a container is created using the image. This also means that the image will be used only to run and target the specific application each time it is called.</p>

<p>Similar to CMD, #Docker allows only one ENTRYPOINT and multiple ENTRYPOINT instructions nullifies all of them, executing the last ENTRYPOINT instruction.</p>

<pre><code>ENTRYPOINT [‘executable’, ‘param1’,’param2’]
ENTRYPOINT command param1 param2
</code></pre>

<p><strong>WORKDIR:</strong> Working directory for the RUN, CMD and ENTRYPOINT instructions can be set using the WORKDIR.</p>

<pre><code>WORKDIR /path/to/workdir
</code></pre>

<p><strong>ENV:</strong> Set environment variables using the ENV instruction. They come as key value pairs and increases the flexibility of running programs.</p>

<pre><code>ENV &lt;key&gt; &lt;value&gt;
</code></pre>

<p><strong>USER:</strong> Set a UID to be be used when the image is running.</p>

<pre><code>USER &lt;uid&gt;
</code></pre>

<p><strong>VOLUME:</strong> Enable access from a container to a directory on the host machine.</p>

<pre><code>VOLUME [‘/data’]
</code></pre>

<h2>DockerFile Best Practices</h2>

<ul>
<li><strong>Do not map</strong> the public <strong>port</strong> directly in the Dockerfile for compatibility and re-usability reasons.</li>
<li>Use <strong>base image</strong> and <strong>caching</strong> as soon as possible : that will reduce image building time and you will write less !</li>
<li><strong>Group</strong> common operation using <code>\</code>.</li>
</ul>


<p>You can read more about DockerFile best practices <a href="http://crosbymichael.com/dockerfile-best-practices.html">here</a>.</p>

<p>Official documentation about Dockerfile on <a href="http://docs.docker.com/reference/builder/#dockerfile-examples">Docker website</a></p>

<h2>What&rsquo;s next &hellip;</h2>

<p>In the next post, I will propose a <strong>workflow</strong> for application development - from <strong>dev to production</strong> - using <strong>Docker</strong>.</p>

<p>So stay tuned :smirk:</p>

<p><em>Alexis</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 11]]></title>
    <link href="http://alexisduque.github.io/blog/2014/08/03/week-11/"/>
    <updated>2014-08-03T08:15:08+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/08/03/week-11</id>
    <content type="html"><![CDATA[<p>Hi everyone :smiley:</p>

<p>This week some update that you can try out !</p>

<h3>First I&rsquo;m happy to annouce the <strong>release</strong> of <strong>Atlas Module 2.0</strong> :earth_africa:</h3>

<p>You can go to <a href="https://modules.openmrs.org/#/show/10/atlas">modules.openmrs.org</a>, download the latest version and update or install it on your server.</p>

<h3><strong>OpenMRS Atlas</strong> 2.0.2 available at <a href="https://atlas.openmrs.org">atlas.openmrs.org</a>.</h3>

<p>This include all tickets and features added in July :</p>

<ul>
<li>Atlas Server support for Atlas Module 2.0.</li>
<li>Admin can query the Atlas database for maintenance or get some stats. :chart_with_upwards_trend:</li>
<li>An <em>Help</em> with instructions to use both Atlas server and module.</li>
<li>Users can share their current atlas view copy/pasting URL provided by <em>Share</em> control.</li>
<li>Users can update their implementation statistics (patients, encounters, observations) directly in Atlas .</li>
<li>An RSS feed with latest changes in OpenMRS Atlas.</li>
</ul>


<h3>Other Work</h3>

<p>I fixed <a href="https://issues.openmrs.org/browse/ATLAS-106">ATLAS-106</a>, that add the possibility for users that manage their marker manually to report their OpenMRS version number in Atlas server.</p>

<p>I continue working on Docker, to propose a worklflow that we can use to easily develop/test and deploy OpenMRS applications, such as Atlas. :whale:</p>

<p>See you :smirk:</p>

<p><em>Alexis</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 10]]></title>
    <link href="http://alexisduque.github.io/blog/2014/07/27/week-10/"/>
    <updated>2014-07-27T08:01:01+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/07/27/week-10</id>
    <content type="html"><![CDATA[<p>Greetings all :smiley:</p>

<p>Beginning writing this post, I realized that was 10 weeks GSoc has started, time go so fast with OpenMRS ! :clock1:</p>

<h2>Atlas project updates</h2>

<p>Most of my work this week was discovering Docker, building container and get information about how we can use it as a new development work flow. That will be the topic of the second part of this post, and I will dedicate a couple of additional posts about it. :whale:</p>

<p>Moreover, I could add new features one the Atlas:</p>

<ul>
<li>Add a share icon to Atlas website to provide link to current view of Atlas. (<a href="https://issues.openmrs.org/browse/ATLAS-101">ATLAS-101</a>, <a href="https://issues.openmrs.org/browse/ATLAS-102">ATLAS-102</a>, <a href="https://issues.openmrs.org/browse/ATLAS-103">ATLAS-103</a>, <a href="https://issues.openmrs.org/browse/ATLAS-104">ATLAS-104</a>)</li>
<li>Finally wrap up the RSS feed (<a href="https://issues.openmrs.org/browse/ATLAS-105.">ATLAS-89</a>)</li>
<li>Push last update on Atlas repo and release Atlas server 2.0.2.</li>
<li>Check my work on the Atlas module, rewrite commits history to prepare its release.</li>
</ul>


<p><img class="left" src="http://alexisduque.github.io/images/ATLAS-104.png" width="300" title="Atlas share link" ></p>

<h2>Introduction to Docker</h2>

<p><img class="left" src="http://alexisduque.github.io/images/docker.png" width="200" title="Docker" ></p>

<p>Docker, is a containerization technique, that let you “build once, configure once and run anywhere” functionalities.</p>

<p>It offers quite a number of interesting features and makes it easy for Developers, Systems Admin and others to quickly test a piece of software in a container; much quicker than a virtual machine, and using less resources.</p>

<h3>Components &amp; Vocabulary</h3>

<ul>
<li><strong>Docker CLI</strong> is the user interface that allows communication between the user and the Docker daemon.</li>
<li><strong>Docker Daemon</strong> sits on the host machine answering requests for services.</li>
<li><strong>Docker Hub</strong> is a centralized registry allowing backup of Docker container images with public and private access permissions.</li>
<li><strong>Docker Containers</strong> are responsible for the actual running of applications and includes the operating system, user added files, and meta-data.</li>
<li><strong>Docker Images</strong> are ready-only templates that help launch Docker containers.</li>
<li><strong>DockerFile</strong> is a file housing instructions that help automate image creation.</li>
</ul>


<h3>Installation</h3>

<p>Install Docker on UNIX is quiet easy. For Ubuntu user just run this script :
<code>curl -s https://get.docker.io/ubuntu/ | sudo sh</code></p>

<p>To verify that everything has worked :
<code>sudo docker verison</code></p>

<p>Docker installation for others OS is well documented <a href="http://docs.docker.com/installation/">here</a>.</p>

<h3>How to start</h3>

<p>To run any application, there is a basic requirement of two steps: <strong>build</strong> an image and <strong>run</strong> the container.</p>

<p><strong>So let&rsquo;s start running an OpenMRS image !</strong></p>

<p>Pull OpenMRS 1.9.7 image hosted on Docker Hub :  <code>docker pull alexisduque/openmrs:1.9.7</code></p>

<p><code>pull</code> command will download the image and add it to your local repository.</p>

<p>This image has Mysql, Tomcat 7, and OpenMRS 1.9.7 deployed with demo data.</p>

<p>Check everything has worked running <code>docker images</code>. That command show all images in your machine.</p>

<p>Build the container and run it : <code>docker run --name openmrs-1.9.7 -p 8080:8080 alexisduque/openmrs:1.9.7</code>
That will create a fresh container, named <em>openmrs-1.9.7&#8217;</em> and launch it.</p>

<p><code>-p</code> parameter is used to bind 8080 container port to 8080 port of your machine. You can easily change it, as example, if you want to bind it to 80 port : <code>`-p 80:8080</code>. <em>Note that your 80 port shouldn&rsquo;t be already used</em></p>

<p>Check everything has worked running <code>docker ps</code>. That command show all container running.</p>

<p>Now, you can go to <a href="http://localhost:8080/openmrs">http://localhost:8080/openmrs</a> (credentials are admin/Admin123)
 :smiley:</p>

<p>You can see that your console is <em>attached</em> to the container. To run in a <em>detached</em> mode, just add <code>-d</code> in the command.</p>

<p>You can stop the container with : <code>docker stop openmrs-1.9.7</code>, and re-run it <code>docker start openmrs-1.9.7</code> (use <code>-a</code> parameter to attach it)</p>

<h3>Tips</h3>

<p>As <strong>Docker need sudo</strong>, you can add an alias in your .bashrc  : <code>'alias docker='sudo docker'</code>.</p>

<p>To <strong>attach</strong> a container running in detached mode, just <code>docker attach container-name</code>.</p>

<p><strong>Delete a container</strong> : <code>docker rm container-name</code></p>

<p><strong>Delete an image</strong> : <code>docker rmi container-name</code></p>

<p>See more in the next post !</p>

<p><em>Alexis</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 9]]></title>
    <link href="http://alexisduque.github.io/blog/2014/07/20/week-9/"/>
    <updated>2014-07-20T06:19:47+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/07/20/week-9</id>
    <content type="html"><![CDATA[<p>Hi everyone,</p>

<p>This week, I worked on various tickets thats are improvements of Atlas Server :</p>

<ul>
<li>SVG logo which is compliant with OpnMRS conventions <em>(<a href="https://issues.openmrs.org/browse/ATLAS-99">ATLAS-99</a>)</em>.</li>
<li>Improved RSS Feed <em>(<a href="https://issues.openmrs.org/browse/ATLAS-89">ATLAS-89</a>, <a href="https://issues.openmrs.org/browse/ATLAS-105">ATLAS-105</a>)</em>.</li>
</ul>


<p><img class="left" src="http://alexisduque.github.io/images/OMRSAtlas.svg" width="400" title="OpenMRS Atlas SVG Logo" ></p>

<p>On other hand, I started making Atlas a <em>Dockerized</em> application, as suggested in <a href="https://issues.openmrs.org/browse/ATLAS-91">ATLAS-91</a>.
Current work can be found here : <a href="https://github.com/alexisduque/atlas-docker.git">https://github.com/alexisduque/atlas-docker.git</a>. :octocat:</p>

<p><img class="left" src="http://alexisduque.github.io/images/docker.png" width="200" title="Docker" ></p>

<p><a href="http://docker.com">Docker</a> extends a container format - LXC (Linux Container) - providing a convenient API, to run in <em>isolation</em> process or applications, and <em>deploy</em> them very quickly. :whale:</p>

<p>Atlas container is based on a ubuntu 14.04 image. The container is build with 2 steps using 2 Dockerfiles :</p>

<ol>
<li><p><code>atlas_base</code>, that builds a base container provisioned will all requirements to run Atlas (i.e. PHP Caravel app). Most important are apache2, mysql5.5, php5.5, phantomjs, composer, git.</p></li>
<li><p><code>atlas_20</code> that uses <code>atlas_base</code> to clone latest sources and configure the application.</p></li>
</ol>


<p>To make think easier, and configurable, all these steps can be done using <code>atlas_laucher.sh</code> bash script and putting your configuration in <code>atlas.cfg</code>. All these information can be found on the README.</p>

<p>If you are interested in Docker, I will share this experiences in  a blog post by the end of July. So, they tuned :smirk:</p>

<p><em>Alexis</em></p>

<p>PS: Thanks to James Arbaugh for his contribution suggesting to get system information from the module (<a href="https://issues.openmrs.org/browse/ATLAS-100">ATLAS-100</a>). That&rsquo;s definitely a good idea ! :+1:</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 8]]></title>
    <link href="http://alexisduque.github.io/blog/2014/07/12/week-8/"/>
    <updated>2014-07-12T08:00:20+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/07/12/week-8</id>
    <content type="html"><![CDATA[<p>Greetings All,</p>

<p>I would like to start this post with a new (awesome) OpenMRS event : <strong>Social Hours</strong>. This Monday, Michael, Paul, Rafa, Wiehwa, Darius and some other guys met for chatting, about what we want, like friends. No formal topics, just open chat, with cam, microphone or just keyboard, to know more about each other. :smiley:</p>

<p>Even if, i was a bit painful for me to join the room at <a href="http://appear.in/openmrs">http://appear.in/openmrs</a> - <em>Chrome</em> did let me connect without cam and microphone !, so I had to switch to <em>Firefox</em> - , it was a really good time.</p>

<p>So a big thanks to Michael for this idea, and I hope we can often meet for <strong>Social Hour</strong> with more and more participants (what about every 2/3 weeks ?).</p>

<p>Next incoming event will be <strong>Wednesday 16 July</strong> from <strong>16:00 to 17:00 UTC</strong>.</p>

<h2>Atlas Project</h2>

<p>This week was a bit special because Burke - my (perfect) mentors - was on holidays, so I can&rsquo;t have his feedback or suggestions and ideas to improve my work :smiley:</p>

<p>But finaly, Michael has good things, and it let me having an other point of view.</p>

<p><strong>So this week :</strong></p>

<ul>
<li>Finished <a href="https://issues.openmrs.org/browse/ATLAS-88">ATLAS-88</a> : Atlas has an RSS feed with last updates <a href="https://atlas-stg.openmrs.org/rss">(try it !)</a>.</li>
<li>Drop a useless column in Archive table. To track atlas database update and change, we use <em>migration</em>, that&rsquo;s a part of <em>Laravel framework</em>. Functionalities are similar to <em>Liquibase</em>, but it uses PHP written files that are created and timestamped for each changes.</li>
<li><a href="https://issues.openmrs.org/browse/ATLAS-92">ATLAS-92</a> : Atlas has an help to give information to user.</li>
<li>When the user save his marker in Atlas module, it sends update - with latest counts and system counts - to Atlas Server.</li>
<li>Update wiki page.</li>
<li>Check Atlas Module, well do its job. :smirk:</li>
</ul>


<p>Next week, I hope we can start working with Burke to release Atlas Module 2.0. That mean merging Atlas Server changes - in order to support module functions - validate changes in Atlas Module, and upgrading Atlas production server.</p>

<p>Moreover, I will probably finish work on <a href="https://issues.openmrs.org/browse/ATLAS-99">ATLAS-99</a> : scale OpenMRS logo in Atlas and make an SVG.</p>

<p><em>Alexis</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 7]]></title>
    <link href="http://alexisduque.github.io/blog/2014/07/06/week-7/"/>
    <updated>2014-07-06T07:48:24+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/07/06/week-7</id>
    <content type="html"><![CDATA[<p>Greetings everybody,</p>

<p>I hope you enjoy Atlas 2.0 and you&rsquo;re going to place your marker :smirk:</p>

<p>This week, I did lot of little improvements related to JIRA ticket :</p>

<ul>
<li><p>In the module, counts that have not been determined are shown as &ldquo;?&rdquo; instead of &ldquo;Undefined&rdquo;. (<a href="https://issues.openmrs.org/browse/ATLAS-98">ATLAS-98</a>)<img class="right" src="http://alexisduque.github.io/images/ATLAS-98.png"></p></li>
<li><p>When a user want to refreshed his site, its unfaded on saving even if information have not changed, and without refreshing the page. <a href="https://issues.openmrs.org/browse/ATLAS-95">(ATLAS-95)</a></p></li>
<li><p>Small UI improvements : we change all <em>Login</em> or <em>Logout</em> to <em>Sign In</em> or <em>Sign Out</em>, regarding convention of other OpenMRS websites such as Talk, ID, or Modulus. <a href="https://issues.openmrs.org/browse/ATLAS-93">(ATLAS-93)</a>. Moreover, as we recently add &ldquo;Last updated&rdquo; date in the bubble, we need to align &ldquo;Why this site is fading away&rdquo; with it. <a href="https://issues.openmrs.org/browse/ATLAS-96">(ATLAS-96)</a></p></li>
<li><p>Atlas administrators have an SQL form only accessible by them using an hidden control in Atlas Server. <a href="https://issues.openmrs.org/browse/ATLAS-88">(ATLAS-88)</a> You can have a look on the screen capture, you probably will never see it !</p></li>
</ul>


<p><img class="left" src="http://alexisduque.github.io/images/atlas-admin.png" width="500" title="Atlas Module Enabled" >
<img class="right" src="http://alexisduque.github.io/images/ATLAS-88.png" width="150" height="300"></p>

<p>On other topic this week was how we can determine OpenMRS Version in the module (remember, the module send the version of implementation that is running). Such as OpenMRS platform and Reference Application has been divided in 2 projects, it&rsquo;s not obvious to know if you run OpenMRS v. > 1.9.7 &lt; 1.11 or OpenMRS 2.0 because they are running over the same core ! Thanks to Rafa and Darius to quickly have gave me some precisions.</p>

<p>So the solution was to know if Reference Application is started, and then get its version. As the solution can be be useful, I share the small function I&rsquo;ve done. And let me know if the is any bugs :smiley:</p>

<pre><code class="java">public String getOpenMRSVersion() {
    String version = "";
    String coreVersion = OpenmrsConstants.OPENMRS_VERSION;
    if (ModuleFactory.getModuleById("referenceapplication") == null || 
            !ModuleFactory.getModuleById("referenceapplication").isStarted())
        return coreVersion;
    String refAppVersion = ModuleFactory.getModuleById("referenceapplication").getVersion();
    version = refAppVersion.equals("1.0.1") ? "2.0" : version;
    return version;
}
</code></pre>

<p>My Actual work is creating a RSS Feed of updates in Atlas. It will probably available soon !</p>

<p><em>Alexis</em></p>

<p>PS : <em>Tour de France</em> started this week-end ! :bicyclist:</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 6]]></title>
    <link href="http://alexisduque.github.io/blog/2014/06/29/week-6/"/>
    <updated>2014-06-29T08:51:36+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/06/29/week-6</id>
    <content type="html"><![CDATA[<p>Hi everyone,</p>

<p>New week, and lot of updates ! First, I&rsquo;m proud to announce that we finally deploy Atlas 2.0 ! You can go to <a href="http://atlas.openmrs.org">atlas.openmrs.org</a> and try it :smiley:</p>

<p>It has not been yet officially announced to the community so we can consider that is a beta version. Update are coming soon with bug fix and new features &hellip; :sweat_drops:</p>

<p>That was also a good occasion to chat with helpdesk and know more about deployment process.</p>

<p>Moreover, as requested by Michael every GSoC student post their video presentation last week. So it was really nice to watch each one, to discover what&rsquo;s happen, and to know other people. We have so different projects, and interaction between use are probably insufficient.</p>

<h2>Atlas project</h2>

<p>Since last 2 weeks, I focus on Atlas Module and features I have to implement on the Atlas server, in order to authorize the module, handle ping with updates, &hellip;</p>

<p>An other task was to wrap up the User Interface of the module. Result in the following captures :</p>

<p><img src="http://alexisduque.github.io/images/module-enabled.png" width="370" title="Atlas Module Enabled" > <img src="http://alexisduque.github.io/images/module-disabled.png" width="370" title="Atlas Module Disabled" >
<img src="http://alexisduque.github.io/images/show-counts.png" title="Show counts in Atlas" ></p>

<p><strong>Other Job done this week : </strong></p>

<ul>
<li>User can edit counts in Atlas Server</li>
<li>User can choose to show counts or not</li>
<li>FIX <a href="https://issues.openmrs.org/browse/ATLAS-83">ATLAS-83</a>, <a href="https://issues.openmrs.org/browse/ATLAS-84">ATLAS-84</a>, <a href="https://issues.openmrs.org/browse/ATLAS-85">ATLAS-85</a>, <a href="https://issues.openmrs.org/browse/ATLAS-86">ATLAS-86</a>, <a href="https://issues.openmrs.org/browse/ATLAS-87">ATLAS-87</a></li>
<li>Release Atlas server 2.0.1.</li>
<li>Refactor Atlas Module API.</li>
<li>Begin work on <a href="https://issues.openmrs.org/browse/ATLAS-88">ATLAS-88</a> : Add a simple SQL form to Atlas Server accessible only to admin.</li>
</ul>


<p>Next week, I will test Atlas Module on the staged server, and check that pings are correctly sent, authorization with module token working, &hellip;.</p>

<p><em>Alexis</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mid Term]]></title>
    <link href="http://alexisduque.github.io/blog/2014/06/21/mid-term/"/>
    <updated>2014-06-21T13:41:32+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/06/21/mid-term</id>
    <content type="html"><![CDATA[<p>Unbelievable, mid-term is coming !! GSoC started 5 weeks ago, 5 weeks having fun, <strong>learning</strong> a lot, improving programming skills, knowing new guys in the <strong>community</strong>, making <strong>friends</strong>, &hellip;.
<strong>Thanks every one !</strong></p>

<p>This week was a bit special for me because I just finished the university semester, that means &hellip;.. <strong>EXAMS</strong>. :blue_book:
So I spent less time chatting, or being focus on the project. But I finally could do some interesting job :</p>

<ul>
<li>Add routing and custom view when Atlas Server is visited from the module.</li>
<li>Log-in and authentication work-flow for the module, force user to log-in if module isn&rsquo;t attached to a site.</li>
<li>Attach/Detach the module to a site.</li>
<li>User can update site statistics in Atlas Server, without the module.</li>
<li>Module UI proposal.</li>
<li>Video presentation.</li>
</ul>


<p>This post is a bit shorter than others because I&rsquo;m preparing a video presentation that will describe precisely Atlas Project goals, and its progression.</p>

<p>So stay tunned :smirk:</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 4]]></title>
    <link href="http://alexisduque.github.io/blog/2014/06/14/week-4/"/>
    <updated>2014-06-14T12:08:13+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/06/14/week-4</id>
    <content type="html"><![CDATA[<p>This week, I began working on Atlas Module, that is the second part of Atlas project . As a transition time, I spent lot of time planning what I have to do and brainstorming: what the module has to do, how the user will use it, what are user needs, how we can make it easy to use. In this task, my mentor is a precious help !  Burke always have good and original idea :smile:</p>

<p>So to put it in a nutshell, that&rsquo;s what the module will do:</p>

<ul>
<li>Display Atlas Server with all these functionalities (sorting, create/edit marker, &hellip;).</li>
<li>Authenticate the module and request authorization for posting data.</li>
<li>Automatically send stats (#patients, modules enabled in OpenMRS instance, &hellip;) to Atlas server.</li>
<li>User should select which information he want to send.</li>
<li>User should activate/deactivate information sending.</li>
<li>User should create a new marker in the Atlas, connected to the Module.</li>
<li>User should pick an existing marker in the Atlas to connect it with the Module.</li>
</ul>


<h2>Module UI</h2>

<p> <em>Atlas Module is accessible as an App in OpenMRS EMR</em></p>

<p><img class="center" src="http://alexisduque.github.io/images/atlas-module.png" width="800" title="Capture control" ></p>

<p><em>User need to log-in with an OpenMRS ID accountm first time, to connect a site to the module.</em></p>

<p><img class="left" src="http://alexisduque.github.io/images/atlas-signin.png" width="800" title="Capture control" ></p>

<p><em>User can pick an existing site in the atlas</em></p>

<p><img class="left" src="http://alexisduque.github.io/images/atlas-me.png" width="800" title="Capture control" ></p>

<p><em>User can configure wich data are send, or disable data sending</em></p>

<p><img class="left" src="http://alexisduque.github.io/images/atlas-config.png" width="800" title="Capture control" ></p>

<h2>Next Week Planning</h2>

<ul>
<li>Finishing <em>Module view</em> in Atlas Server

<ul>
<li><em>pick a site</em></li>
<li><em>information message</em></li>
</ul>
</li>
<li>Make video presentation</li>
</ul>


<p>Next week will be busy for me because of my final exams. Sorry if I don&rsquo;t perform at 100% :smirk:</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 3]]></title>
    <link href="http://alexisduque.github.io/blog/2014/06/07/week-3/"/>
    <updated>2014-06-07T07:10:17+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/06/07/week-3</id>
    <content type="html"><![CDATA[<p>Week 3 is ending soon and there are only 3 weeks before GSoC mi-term, time go so fast with OpenMRS ! :clock1:</p>

<p>For this week, goals are all reached, and I can do what I have planned, thanks to everybody help me fixing blockers, or answering questions.</p>

<ul>
<li>Reviewing and improving what I did last week.</li>
<li>Setup OpenMRS 2.0 and reference application on my local dev environment.</li>
<li>Restablish markers fading on Atlas.</li>
<li>Write documentation for Atlas server deployment.</li>
<li>Setup Atlas correctly on staged.</li>
<li>Make Atlas module 1.2 working across 1.x and 2.x OpenMRS version.</li>
<li>Put an app link on OpenMRS 2.</li>
</ul>


<h2>Community interactions</h2>

<p>My university planning let me participate in many daily scrum, and attend developer forum. Nice :smile:</p>

<p>As I had some blockers setting up OpenMRS 2.0, I required Helpdesk intervention on stagged sever, so it was good reasons to chat with community members other than my mentor. And be active on the mailing list :smirk:</p>

<p>So what I can say is : <strong>Having problems helps make friends !</strong></p>

<h2>Tips</h2>

<p>Set up OpenMRS 2.0 on my laptop was really painful, and I probably can&rsquo;t do it with precious help of Rafa and Darius. :+1:So, I would like to share what I have to do, if it can help.</p>

<p><strong> My config </strong></p>

<ul>
<li>Ubuntu 14.04</li>
<li>Java 1.8</li>
<li>MySQL</li>
<li>OpenMRS running over Jetty</li>
</ul>


<p><strong> The problems </strong></p>

<p>Reference application won&rsquo;t start. After running Jetty and doing first setup, I have a blank page at localhost/openmrs.
Error on Java version with a message like this : OpenMRS requires Java > 6, 1.8 is present :worried:</p>

<p><strong> Solution </strong></p>

<ul>
<li>Clean everything related to OpenMRS previous install (openmrs database, temp files)</li>
<li>Clone 1.10.x branch of openmrs-core</li>
<li>Clone master of openmrs-distro-referenceapp</li>
<li>Switch to Java JDK and JRE v1.7:
<code>sh
sudo update-alternatives --config java
sudo update-alternatives --config javac
</code></li>
<li>Follow this good <a href="https://wiki.openmrs.org/display/projects/Setting+Up+a+Development+Environment+for+OpenMRS+EMR+2.0">WIKI</a></li>
<li>Important : take care your database encoding is set to <code>utf8</code>, and collation to <code>utf8_unicode_ci</code>.</li>
<li><p>Run it
<code>sh
cd openmrs-core/webapp
mvn jetty:run
</code></p>

<h2>Next Week Planning</h2></li>
<li><p>Announce new OpenMRS Atlas.</p></li>
<li>Stay tuned for community comments, suggestions and improvement idea.</li>
<li>Bug fix : I hope not :smirk:</li>
<li>Plan work on Atlas module.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 2]]></title>
    <link href="http://alexisduque.github.io/blog/2014/06/01/week-2/"/>
    <updated>2014-06-01T06:32:38+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/06/01/week-2</id>
    <content type="html"><![CDATA[<p>An other awesome week spend with OpenMRS and developer team. Atlas 2.0 is coming soon :smile:</p>

<p>We expected we could deploy it on new host this week, but with with Memorial Day Monday and Ascension Day Tuesday and Friday, we couldn&rsquo;t.</p>

<p>But waiting for infrastructure means working locally, so I add a couple of nice functionalities in Atlas :</p>

<ul>
<li>Improve Archive and Sites changes tracking saving new informations : created_by, changed_by.</li>
<li>A designated Administrator can edit/move or delete any marker in Atlas.</li>
<li>A screen capture feature, for easily exporting Atlas map and markers to an HD .png image.</li>
<li>Grabbing some informations and reading wiki, about openMRS module compatibility across 1.x et 2.x version.</li>
<li>Remove CDN dependencies and use HTTPS instead of HTTP, for external links, as requested by Helpdesk.</li>
<li>Planning next weeks work on Atlas Module.</li>
</ul>


<p>  <img class="left" src="http://alexisduque.github.io/images/capture.png" title="Capture control" ></p>

<h2>Community interactions</h2>

<p>As each week, if my university schedule let me,  I use to participate in Scrum daily, and I really like it. :+1:
Know what developers do, how are going other student projects, or what are next OpenMRS goals and milestones (as new release) is interesting, and help me to feel as an OpenMRS community member.</p>

<p>Unfortunately, I missed Developer Forum, this week .
As Tuesday was holiday in France, I participate in a duathlon race (5km:running:+ 30km:bike: +5km:running: - yes, I use km and not miles :stuck_out_tongue_closed_eyes: ), and I couldn&rsquo;t attend or chat with Burke. :confused:.</p>

<p>Moreover, each time I post a question on Forum, I&rsquo;m really surprised how quickly community give me a answer. Thank every body. :+1: So, in the future, I will try to help as soon as I can answer or solve the problem.</p>

<h2>Technical Aspect</h2>

<p><img class="right" src="http://alexisduque.github.io/images/phantomjs.png" title="PhantonJS" >
 I&rsquo;ve discovered a new tools, developing screen capture feature: PhantomJS. It&rsquo;s headless Webkit scriptable with JavaScript and Jquery. So, it renders webpages, can navigate on it, but never display them. It is often used for web testing, page scraping, or making screenshot.  In a future post, I will present how I use it to capture Atlas picture</p>

<h2>Next Week Planning</h2>

<ul>
<li>Meet with Burke for review my work.</li>
<li>Setup Atlas 2.0 on stagged server.</li>
<li>Write documentation for Helpdesk to deploy Atlas 2.0</li>
<li>Switch to Atlas Module, probably adding new dependencies and make Atlas 1.2 running with OpenMRS 2.0</li>
</ul>


<p><em>Ciao</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week planning]]></title>
    <link href="http://alexisduque.github.io/blog/2014/05/26/week-planning/"/>
    <updated>2014-05-26T08:06:05+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/05/26/week-planning</id>
    <content type="html"><![CDATA[<p>My TODO List for this Week #2 :</p>

<ul>
<li>Keep contact with Helpdesk about new Atlas server host.</li>
<li>Deploy Atlas 2.0.</li>
<li>Probably fix some little bugs</li>
<li>Add Admin capability to edit/delete all marker</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week 1]]></title>
    <link href="http://alexisduque.github.io/blog/2014/05/24/week-1/"/>
    <updated>2014-05-24T19:55:05+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/05/24/week-1</id>
    <content type="html"><![CDATA[<p>Hi everyone :smile:</p>

<p>If you miss the information,  GSOC just started this Monday ! This is my weekly update for this first week <em>having fun</em> with OpenMRS !</p>

<h2>Community interactions</h2>

<p>I&rsquo;ve participated in my first Daily Scrum on IRC, with other OpenMRS Dev and GSoC Students. Cool time, everyone tell what he did, what he plan to do, and if he has any blocker task. So we can keep posted what each other does, and ask for help if we have any problem or blocker.</p>

<p>Monday, I had a long chat we my mentor, to discuss what I have done on Atlas Server and how I can improve it.</p>

<p>We solve a blocker too : how we can manage authorization, marker creation and update from Atlas Server.</p>

<p>And Friday, regarding new features, and project progress, Burke said we will be able to deploy Atlas 2.0 to production server, probably next week: :earth_africa:</p>

<h2>Project Updated</h2>

<h3>Atlas Front-end</h3>

<ul>
<li>User can create a new marker in Atlas server.</li>
<li>User has a form in the bubble to edit bubble data.</li>
<li>Add a popup to confirm marker deletion.</li>
<li>Prevent sending openmrs_id and secret UUID (id) on the client side : only uuid of markers a user is allowed to edit is sended, others are kept secret.</li>
<li>Cleaning up JS code.</li>
</ul>


<h3>Database</h3>

<p>Actually, Atlas Module create a UUID, used as a token to authenticate the module and allow data update (#patients, OpenMRS Version, Installed modules, &hellip;). This UUID is used too, as Primary Key in the database and is never send to the client on the Atlas (remember is secret !).</p>

<p><strong>The Solution</strong> : Burke suggested me to create a table AUTH to define marker update permissions. Both users and modules will update or remove a marker (human/non-human): what is refering to <em>principal</em> concept. This extra Auth table allow the possibility to have multiple users with different permissions, to update a marker.</p>

<ul>
<li>Added <strong>openrmrs_id</strong> column in <strong>atlas table</strong> to register marker ownership.</li>
<li>An <strong>Auth row</strong> is linked to <strong>Atlas row</strong> with the Foreign Key <strong>atlas_id</strong> -> <strong>id</strong></li>
<li>All these changes has been done using Laravel Migration, a very useful tool for database versioning. It&rsquo;s a bit a PHP clone of <em>Liquibase</em></li>
</ul>


<p><strong>Database Schema</strong></p>

<p><img class="left" src="http://alexisduque.github.io/images/db.png" title="New database schema" ></p>

<h3>Atlas Back-end</h3>

<ul>
<li>Replace PDO Query to <strong>Laravel QueryBuilder</strong> : <em>(less verbose, protect against SQL injection)</em>.</li>
<li>Move Ping and Data functions to Controllers instead of View.</li>
<li>Implements <em>marker persistence</em> and <em>authorization</em>.
Goodg job, for this first week !</li>
</ul>


<p>See you :-)</p>

<p><em>Alex</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Multipass and SSO]]></title>
    <link href="http://alexisduque.github.io/blog/2014/05/17/multipass-and-sso/"/>
    <updated>2014-05-17T11:45:50+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/05/17/multipass-and-sso</id>
    <content type="html"><![CDATA[<p>The first challenge of this summer of code is to authenticate a user - with his OpenMRS ID - directly inside Atlas website.</p>

<h2>What is OpenMRS ID</h2>

<p>OpenMRS ID is the system of user management used by the <strong>OpenMRS Community</strong>. User accounts are managed and created using the OpenMRS ID Dashboard, a web app written in <strong>Node.js</strong>.
Data model is built around <strong>LDAP</strong> user object and stored on an OpenLDAP server. In order to support unified authentication for all OpenMRS sites and external services, ID Dashboard also provides a <strong>SSO endpoints</strong>.</p>

<h2>What is SSO</h2>

<p><strong>Single Sign On</strong> (SSO) is a session/user authentication process that allows a user to provide his credentials once in order to access multiple applications. The single sign on authenticates the user to access all the applications he has been authorized to access. It eliminates future authenticaton requests when the user switches applications during that particular session.</p>

<p>Various implemention and straegies exist, such as <strong>OAuth</strong>, <strong>SAML</strong>, <strong>Multipass</strong>, <strong>CAS</strong> or <strong>Facebook Connect</strong>. Actually, ID Dashboard only support Multipass strategy but a project aimed to make a REST API based on OAuth and OpenID.</p>

<h2>What is Multipass and how we use it</h2>

<p>In order to authenticate users, OpenMRS ID dashboard pass an encrypted multipass JSON hash with the user&rsquo;s information to Atlas site. When the multipass token is received, an associated user record is created, with the information provided, and logged in current session using cookie.</p>

<p>A multipass hash is an <strong>AES encrypted JSON</strong> hash with the following attributes:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;uid&quot;</span><span class="o">:</span> <span class="s2">&quot;19238333&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;expires&quot;</span><span class="o">:</span> <span class="s2">&quot;2014-12-29T10:25:28-08:00&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;user_email&quot;</span><span class="o">:</span> <span class="s2">&quot;john@example.com&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;user_name&quot;</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>How it is implemented ?</h2>

<p><strong>Multipass</strong> is build and encrypted on the ID Dashboard side wih <strong>Node.js</strong>.
On the other side, Atlas server check and decode multipass with a <strong>PHP implementation</strong> and <strong>mcrypt</strong> library.</p>

<pre><code class="php Atlas Server Decode Multipass linenos:false">public function decodeMultipass()
{
    $token = $_GET['multipass'];
    $signature = $_GET['signature'];
    $iv = 'OpenSSL for Node';

    $subdomain = $SITE_KEY;
    $api_key = $API_KEY;
    $salted = $api_key . $subdomain;
    $digest = hash('sha1', $salted, true);
    $key = substr($digest, 0, 16);
    $blocksize = 16;

    // Signature Verification
    $hash == base64_encode(hash_hmac("sha1", $token, $api_key, true));

    if ($hash = $signature) {
        // Replace _ with / and - with +
        $token = preg_replace('/_/', '/', $token);
        $token = preg_replace('/\-/', '+', $token); 
        $token = base64_decode($token);

        // Decrypt Token
        $cipher = mcrypt_module_open(MCRYPT_RIJNDAEL_128,'','cbc','');
        mcrypt_generic_init($cipher, $key, $iv);

        $decrypted = mdecrypt_generic($cipher,$token);

        // Remove invisble character
        $decrypted = trim($decrypted, "\x00..\x1F");
        $userToken  = json_decode($decrypted);
    }
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week -1]]></title>
    <link href="http://alexisduque.github.io/blog/2014/05/17/week-1/"/>
    <updated>2014-05-17T06:21:54+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/05/17/week-1</id>
    <content type="html"><![CDATA[<p>Hey, let&rsquo;s start for a pre-start weekly report ! As mentioned in my previous post, goals this week were to wrap up the timeline and UI, fixing priorities and begin coding (officially not really ;-)
So, week starts with a cool hangout with my mentor. Talking with Burke is really a nice time, a good exercise for me to practise my spoken english, and to be more comfortable with OpenMRS developers community.</p>

<p>Burke gave grant me access to a dev server (Ubuntu 14.04 :+1:) hosted by DigitalOcean. Abolutely unknown Cloud provider in France ! I will often push my work to share it with OpenMRS developers. You can have a look here : <a href="http://107.170.156.44">Atlas Server 2.0</a>.</p>

<p>On other hand, we have interesting email discussions with Elliott, about SSO, Auth stategy, and <a href="https://wiki.openmrs.org/display/projects/OpenMRS+ID+Platform+Improvements">OpenMRS ID project</a> (assigned to Wiehwa). As I&rsquo;m really interested in security topics, it was really cool. Elliott looks to be an expert and I learnt a lot. :bowtie:</p>

<p><strong>What has been done this week :</strong></p>

<ul>
<li>Refactoring Atlas Server with Laravel</li>
<li>Atlas multipass auth strategy, allowing a user to authenticate with his OpenMRS ID in Altas Server.</li>
<li>Add a dropdown menu providing controls for future marker management function.</li>
<li>Add icons (trash, pencil, pad lock) on the bottom right corner of marker bubble.</li>
</ul>


<p><img class="left" src="http://alexisduque.github.io/images/menu.png" title="New dropdown menu" >
<img class="center" src="http://alexisduque.github.io/images/bubble-me.png" title="User owned marker" >
<img class="right" src="http://alexisduque.github.io/images/bubble.png" title="A maker bubble" ></p>

<p><strong>Next Week Planning : </strong></p>

<ul>
<li>Discuss Atlas database re-designing.</li>
<li>User can create and edit a new marker (marker data not yet saved, just UI).</li>
</ul>


<p> See you next week with update.  :smirk:</p>

<p> <em>Alex</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Week -2]]></title>
    <link href="http://alexisduque.github.io/blog/2014/05/09/weeks-2/"/>
    <updated>2014-05-09T13:04:00+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/05/09/weeks-2</id>
    <content type="html"><![CDATA[<p>We are ten days before official GSOC begining , and I&rsquo;m so impatient to start !</p>

<p>This week was a productive week :+1:</p>

<ul>
<li>First hangout with Burke, my mentor. It was really nice to see and chat with him, even if I am a bit shy :relaxed:</li>
<li>Timeline adjustement.</li>
<li>New mockup and screenshot.</li>
<li>Discussion about SSO strategies for OpenMRS ID sign-in within Atlas Server.</li>
<li>I set up a local instance of OpenMRS ID Dashboard. I was a bit painful with OpenLDAP configuration, but I&rsquo;m now ready to test authentification. :sweat_smile:</li>
<li>Some hack around SSO and multipass implementation for atlas.</li>
<li>I Start to refactor Atlas Server with Laravel, a great PHP Framework.</li>
</ul>


<p><strong>TODO</strong></p>

<ul>
<li>Review mockups with Burke</li>
<li>Finish Atlas upgrade to Laravel</li>
<li>Timeline wrapping up</li>
</ul>


<p>  <em>Alex</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Community Bonding and Planning]]></title>
    <link href="http://alexisduque.github.io/blog/2014/05/01/community-bonding-and-planning/"/>
    <updated>2014-05-01T12:53:40+02:00</updated>
    <id>http://alexisduque.github.io/blog/2014/05/01/community-bonding-and-planning</id>
    <content type="html"><![CDATA[<p>Before I start coding and working really on Atlas project, I began to plan my work, precising project timeline, and functionnalities I will implement this summer.</p>

<p>So during these few weeks of community bonding, with the precious help of Burke, I will design some protoypes, mockups and user stories to have a clear idea of how a user will interact with new Atlas Module release.</p>

<p><strong> See you next week ! </strong> :smile:</p>

<p><em>PS : Maybe I will post a quick introduction to Multipass SSO. I&rsquo;m getting some documentation about it, to be able to work with. I thought it&rsquo;s a good idea sharing new skills with you :-)</em></p>

<h2>Here is a first Timeline prototype :</h2>

<h3>21 April – 18 May</h3>

<ul>
<li>Getting familiar with Atlas Module and OpenMRS ID SSO <strong><em>(work in progress)</em></strong></li>
<li>Fixing some Atlas related Tickets <strong><em>(done)</em></strong></li>
<li>Designing the project Road Map <strong><em>(work in progress)</em></strong>

<ul>
<li>Story Board</li>
<li>Mockup</li>
<li>Timeline week by week</li>
</ul>
</li>
<li>Community bonding participating in community events <strong><em>(work in progress)</em></strong></li>
</ul>


<h3>19 May – 31 May</h3>

<ul>
<li>Add Sign In form for OpenMRS ID</li>
<li>Add OpenMRS ID SSO dependency in Atlas Module.</li>
</ul>


<h3>1 June 1 – 30 June</h3>

<ul>
<li>User can sign in successfully with his OpenMRS ID in Atlas Module</li>
<li>Atlas Module ported to OpenRMS 2.0 (whith a look like google app style)</li>
</ul>


<h3>1 July – 12 July</h3>

<ul>
<li>An existing marker can be associated with an OpenMRS ID in Atlas Module.</li>
<li>Add function to &ldquo;recover&rdquo; control of a marker using the registered OpenMRS ID
A marker can be created and updated directly in the Atlas Server.</li>
</ul>


<h3>13 July – 26 July</h3>

<ul>
<li>New administrative screens in Atlas Server to manage markers (move, remove outdated or invalid markers)</li>
</ul>


<h3>10 August – 15 August</h3>

<ul>
<li>Extra features in Atlas Server : map exporting as a slide for presentation, marker filtering by type or version</li>
</ul>


<h3>16 August – 22 August</h3>

<ul>
<li>Wrapping up project, final touches.</li>
<li>Writing Wiki and developer doc.</li>
</ul>

]]></content>
  </entry>
  
</feed>
